require(["jquery","getRequest","storage","jsonp","base64","render"],function(t,c,i,e,s,a){var n=c().fiction_id,o=c().chapter_id||i.get("chapter_id")||1,l=t(".set-t"),r=t(".set-b"),d=t(".mask"),h=t(".style-panel");t(".artical-con").on("click",function(){l.show(),r.show(),d.show()}),d.on("click",function(){l.hide(),r.hide(),d.hide(),h.hide(),t(".size").removeClass("active")}),t(".icon-circle-back").on("click",function(){window.location.href="detail.html?fiction_id="+n}),t(".size").on("click",function(){h.toggle(),t(this).toggleClass("active")}),t(".day").on("click",function(){t(this).toggleClass("change");var c="";c="白天"==t(this).find("dd").html()?"夜晚":"白天",t(this).find("dd").html(c)});var f=i.get("fz")||14;function u(c){t.ajax({url:"/api/articalUrl?chapter_id="+c,dataType:"json",success:function(c){console.log(c);var i=c.jsonp;e({url:i,cache:!0,callback:"duokan_fiction_chapter",success:function(c){var i=decodeURIComponent(escape(s.decode(c))),e=JSON.parse(i);a("#artical-tpl",e,".artical-con"),t("p").css("font-size",f/37.5*1+"rem")}})},error:function(c){console.warn(c)}})}t(".large-btn").on("click",function(){f<24&&(f+=2),t("p").css("font-size",f/37.5*1+"rem"),i.set("fz",f)}),t(".small-btn").on("click",function(){12<f&&(f-=2),t("p").css("font-size",f/37.5*1+"rem"),i.set("fz",f)});var g=t("#pre-btn"),p=t("#next-btn"),b=t("#charpter-num");p.on("click",function(){o<4&&(u(++o),g.removeClass("disabled")),4==o&&t(this).addClass("disabled"),b.html(o+"/"+m),i.set("chapter_id",o)}),g.on("click",function(){console.log(),1<o&&(u(--o),p.removeClass("disabled")),1==o&&t(this).addClass("disabled"),b.html(o+"/"+m),i.set("chapter_id",o)}),t(".bg-list").on("click","li",function(){t(this).addClass("active").siblings().removeClass("active");var c=t(this).attr("bg-color");t(".artical-con").css("backgroundColor",c),i.set("bg",c)}),t(".chapter").on("click",function(){window.location.href="../../page/chapter-list.html?fiction_id="+n+"&chapter_id="+o});var m,v,k=i.get("bg")||"#f7eee5";v=n,t.ajax({url:"/api/chapter?fiction_id="+v,dataType:"json",success:function(c){m=c.item.toc.length,b.html(o+"/"+m)},error:function(c){console.warn(c)}}),u(o),t(".artical-con").css("backgroundColor",k),t(".bg-list li[bg-color="+k+"]").addClass("active").siblings().removeClass("active"),1==o?g.addClass("disabled"):4==o&&p.addClass("disabled")});